# NeckRange AI - 要件定義書

## 1. プロジェクト概要

### サービス名
**NeckRange AI（ネックレンジAI）**

### 目的
画像認識技術を用いて、ユーザーの首の左右への傾き（側屈）の角度を測定し、柔軟性や姿勢のバランスを簡易診断する。

### ターゲットユーザー
- デスクワーカー
- 整体・フィットネス事業者
- 自身の姿勢に関心がある一般ユーザー

### プラットフォーム
- ウェブブラウザ（PCおよびスマートフォン対応）
- ブラウザ完結型（サーバーへの画像送信なし）

---

## 2. 実装済み機能

### ✅ 画像入力機能
- 正面静止画像（基準）のアップロード/撮影
- 右側屈画像のアップロード/撮影
- 左側屈画像のアップロード/撮影
- 撮影ガイドラインのオーバーレイ表示

### ✅ AI解析機能
- MediaPipe Poseによる33個のキーポイント検出
- 主要ランドマーク：鼻、左右の肩、左右の耳、左右の目

### ✅ 代償動作検知
- 両肩を結ぶ線の角度計算
- 許容範囲：±5°以内
- 範囲外の場合は警告メッセージ表示

### ✅ 角度測定
- 正面画像を基準とした側屈角度の計算
- 左右それぞれの可動域測定

### ✅ 診断機能
- 測定角度の表示（右側屈・左側屈）
- 正常値との比較（成人平均：45°〜50°）
- 「硬い」「やや硬い」「普通」「柔軟」の評価
- 左右差の判定とフィードバック

### ✅ ビジュアルフィードバック
- Canvas上にランドマーク描画
- 骨格線（スケルトン）表示
- 肩の水平線表示（色分け）
- 首の角度線表示
- リアルタイムガイドライン

---

## 3. 技術スタック

- **React** 18.2.0
- **TypeScript** 5.2.2
- **MediaPipe Pose** 0.5.x
- **Tailwind CSS** 3.4.0
- **Vite** 5.0.8
- **Canvas API**

---

## 4. アルゴリズム

### 肩の水平チェック
```
α = arctan((y_sl - y_sr) / (x_sl - x_sr)) × 180/π
判定: |α| > 5° の場合、エラー
```

### 首の傾き角度測定
```
両肩の中点M = ((x_sr + x_sl)/2, (y_sr + y_sl)/2)
θ = arctan((x_n - x_m) / (y_m - y_n)) × 180/π
```

---

## 5. 評価基準

### 可動域の評価
- **硬い**: 30°未満
- **やや硬い**: 30°〜40°
- **普通**: 40°〜50°
- **柔軟**: 50°以上

### 左右差の評価
- **正常**: 5°未満
- **軽度**: 5°〜10°
- **中等度**: 10°〜15°
- **顕著**: 15°以上

---

## 6. 今後の拡張

- 履歴機能
- PDF出力
- 多言語対応
- 動画からのリアルタイム測定
- 他の部位の測定

---

## ライセンス
MIT License
